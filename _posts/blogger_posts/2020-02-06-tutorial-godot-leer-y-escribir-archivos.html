---
layout: post
title: 'Tutorial Godot: Leer y escribir archivos'
date: '2020-02-06T08:48:00.000-06:00'
author: Deybis A. Melendez Vargas
tags:
- tutorial
- Godot Engine
modified_time: '2020-02-06T09:16:07.514-06:00'
thumbnail: https://1.bp.blogspot.com/-bO9ecfKMYGs/XjwmkZ_xDRI/AAAAAAAABpI/fpoC1IpaQK0VseZOrLMtK8fFM4CeooMUQCLcBGAsYHQ/s72-c/Captura%2Brealizada%2Bel%2B2020-02-06%2B08.45.07.png
blogger_id: tag:blogger.com,1999:blog-5503112308634825503.post-7964528136533727741
blogger_orig_url: https://www.deybismelendez.com/2020/02/tutorial-godot-leer-y-escribir-archivos.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-bO9ecfKMYGs/XjwmkZ_xDRI/AAAAAAAABpI/fpoC1IpaQK0VseZOrLMtK8fFM4CeooMUQCLcBGAsYHQ/s1600/Captura%2Brealizada%2Bel%2B2020-02-06%2B08.45.07.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="500" data-original-width="726" height="440" src="https://1.bp.blogspot.com/-bO9ecfKMYGs/XjwmkZ_xDRI/AAAAAAAABpI/fpoC1IpaQK0VseZOrLMtK8fFM4CeooMUQCLcBGAsYHQ/s640/Captura%2Brealizada%2Bel%2B2020-02-06%2B08.45.07.png" width="640" /></a></div><br />Antes de comenzar el tutorial es necesario aclarar algunos puntos importantes para no confundir cuando se programe este tipo de cosas.<br /><ol><li>El editor de Godot no reconoce archivos de texto.</li><li>Aunque estés trabajando con archivos de texto como *.txt, *.md, *.json, *.xml, etc. No lo verás en el editor pero eso no significa que Godot no puede acceder a estos archivos.</li><li>Para almacenar información del usuario, debes usar el directorio user:// (explicado mas adelante).</li><li>Las pruebas directas desde el editor podrán leer cualquier archivo que desees, incluso fuera de la carpeta del proyecto, pero cuando exportes debes declarar que el archivo o la extensión del archivo debe ser importado, de lo contrario cuando exportes no funcionará.</li></ol><h3>Ahora sí, pasamos al tutorial.</h3>Para poder acceder a los archivos Godot ofrece una clase llamada File, con ella tenemos todos los métodos necesarios para realizar tanto lectura como escritura de archivos.<br /><br />Vea el siguiente código.<br /><br /><pre><code>func write(dir, data):# dir seria la ubicacion del archivo y data el dato a guardar<br />&nbsp;&nbsp;&nbsp; var file = File.new() # Instanciamos un File<br />&nbsp;&nbsp;&nbsp; file.open(dir, File.WRITE) # Abrimos el archivo en modo escritura<br />&nbsp;&nbsp;&nbsp; file.store_string(data) #Almacenamos el dato como texto si no:<br />&nbsp;&nbsp;&nbsp; # file.store_var(data) en caso de querer almacenar una variable, como un dict o array<br />&nbsp;&nbsp;&nbsp; file.close() # Siempre debemos cerrar el file </code></pre>Aparte de store_string y store_var hay mas métodos que se pueden usar, como store_line para almacenar solo una linea de texto, store_real para almacenar un número flotante, o store_64 para almacenar números.<br /><br />Si quieres almacenar una cantidad de variables puedes poner el método store_*(lo que sea) varias veces y godot almacenará las variables en ese orden, lo que significa que cuando necesitemos leer estas variables tenemos que hacerlo también en el mismo orden exacto, para evitar problemas, yo te recomendaría almacenar un diccionario directamente.<br /><br />Otro dato importante es que no se puede almacenar escenas completas de esta manera, tampoco es recomendado, lo mejor sería aplicar un <a href="https://es.wikipedia.org/wiki/Factory_Method_(patr%C3%B3n_de_dise%C3%B1o)" target="_blank">patrón de Factory</a> y almacenar los datos importantes de la escena. Creas un método de factory que instancie una escena prefabricada y con los datos almacenados modificas la escena para dejarla cómo la guardaste.<br /><br />Ahora veamos cómo leer archivos:<br /><pre><code>func read(dir): # dir seria la ubicacion del archivo<br />&nbsp;&nbsp;&nbsp; var file = File.new() # Instanciamos un File<br />&nbsp;&nbsp;&nbsp; if not file.file_exists(dir): # Nos aseguramos que el archivo a leer existe<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return null # Retornamos null y no hacemos nada si no existe el archivo<br />&nbsp;&nbsp;&nbsp; file.open(dir, File.READ) # Abrimos el archivo en modo lectura<br />&nbsp;&nbsp;&nbsp; var data = file.get_as_text() # obtenemos el contenido en formato texto, sino:<br />&nbsp;&nbsp;&nbsp; # var data = file.get_var() # en caso de haber almacenado una variable<br />&nbsp;&nbsp;&nbsp; file.close()<br />&nbsp;&nbsp;&nbsp; return data # Devolvemos el dato leido.</code></pre>Siempre es importante consultar si el archivo a leer existe, porque si intentamos abrir un archivo que no existe nos dará un error.<br /><br /><h3>Res y User</h3><br />res:// es el directorio donde se almacena el código fuente del juego, user:// es el directorio que Godot te asegura para almacenar datos del usuario, la ubicación del directorio depende del sistema operativo.<br /><br />En windows el directorio sería:<code>%APPDATA%\Godot\app_userdata\Project Name</code><br />En linux el directorio sería:<code>$HOME/.godot/app_userdata/Project Name</code><br />Con el método OS.get_user_data_dir() podemos obtener el directorio por defecto según el dispositivo.<br /><br />Sí deseas almacenar datos como las puntuaciones, estado del jugador, nombre de jugador, inventario, etc. Debes usar el directorio user://, en caso de necesitar simplemente leer una lista o una base de datos entonces usar res://<br /><br />No uses res:// si vas a necesitar escribir en el archivo.<br /><h3>Comprobando el código</h3>Podemos hacer una escena sencilla con un nodo Control y de hijos un Button y un LineEdit y agregamos un script con lo siguiente:<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-EU3dI0a4As4/Xjwq2sOrd2I/AAAAAAAABpk/OLtvId5bB-Aw4SGUQk_pUNLEDjrZAPCCQCLcBGAsYHQ/s1600/Captura%2Brealizada%2Bel%2B2020-02-06%2B09.02.28.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="293" data-original-width="623" height="300" src="https://1.bp.blogspot.com/-EU3dI0a4As4/Xjwq2sOrd2I/AAAAAAAABpk/OLtvId5bB-Aw4SGUQk_pUNLEDjrZAPCCQCLcBGAsYHQ/s640/Captura%2Brealizada%2Bel%2B2020-02-06%2B09.02.28.png" width="640" /></a></div>Data es el script donde guardamos los métodos write y save, y lo cargamos como un autoload.<br />Así, podemos escribir algo en el LineEdit y dar clic en el botón Save, cerramos el juego y lo volvemos abrir y veremos lo que hemos guardado escrito en el LineEdit.