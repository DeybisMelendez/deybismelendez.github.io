---
layout: post
title: 'Devlog: Cómo hice el simulador de raqueta mata mosquitos'
date: '2020-03-15T09:42:00.000-06:00'
author: Deybis A. Melendez Vargas
tags:
- videojuegos
- Godot Engine
- android
- devlog
modified_time: '2020-03-15T09:42:28.178-06:00'
thumbnail: https://1.bp.blogspot.com/-a6Fq2oEf3UU/Xm5Cie80loI/AAAAAAAABtg/4HNibTwo3GAZkKhwEaJ_EXroIGM4G4HNQCLcBGAsYHQ/s72-c/Screenshot_20200315-085758.png
blogger_id: tag:blogger.com,1999:blog-5503112308634825503.post-9199539018641651172
blogger_orig_url: https://www.deybismelendez.com/2020/03/devlog-raqueta-mata-mosquitos-simulador.html
---

Hace algunos días vi en facebook que hicieron meme con una app que se llama "aire acondicionado" y es que el chiste está en que podés descargarlo y tener "aire acondicionado" en tu celular, obviamente esto no es cierto.<br /><br />Al mismo tiempo recordé que hace tiempo vi apps como "martillo" que no era nada mas que una imagen de martillo en tu celular, lo chistoso es que aseguraba convertir tu celular en un martillo, ya te imaginarás el resultado, también apps de tipo "descargar memoria RAM" o incluso "app que no hace nada" donde era una app en blanco que literalmente no hacía nada.<br /><br />Todo esto me llevó a animarme a crear algo parecido, como algunos de los que me conocen saben que mi sentido del humor muchas veces roza lo absurdo, pasé todo el día pensando en qué hacer.<br /><br />Una app de plagatox fue lo primero que se me vino a la mente, pero yo no quería hacer una simple app de una imagen, yo quería hacer algo que se sienta mas realista y que se pueda manipular, fue entonces charlando con alguien que se me ocurrió hacer la raqueta mata mosquitos, claro, ahí no solo iba a poner una imagen si no también podía hacerlo como simulador, donde agitando el celular podrías matar mosquitos, investigué en la playstore y aunque hay muchas apps que aseguran matar o espantar mosquitos, no había una como la que tenía pensado yo.<br /><br />Lo siguiente fue pensar en qué tecnología usar, incluso tenía en mente Love2D, ya que no es una app tan complicada de hacer, pero al final me decidí por Godot Engine, ya que próximamente pienso agregarle algún sistema de anuncios alternativo a admob, para ir probando los nuevos plugins de la versión 3.2 que ya se pueden trabajar con empresas como AdColony o MoPub por ejemplo.<br /><b><br /></b><b>Al final del devlog te dejo los enlaces para que puedas ver el código fuente y/o descargar la aplicación.</b><br /><br /><h2>La app</h2><br />La app se ve así:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-a6Fq2oEf3UU/Xm5Cie80loI/AAAAAAAABtg/4HNibTwo3GAZkKhwEaJ_EXroIGM4G4HNQCLcBGAsYHQ/s1600/Screenshot_20200315-085758.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="1600" data-original-width="900" height="400" src="https://1.bp.blogspot.com/-a6Fq2oEf3UU/Xm5Cie80loI/AAAAAAAABtg/4HNibTwo3GAZkKhwEaJ_EXroIGM4G4HNQCLcBGAsYHQ/s400/Screenshot_20200315-085758.png" width="225" /></a></div>La estructura de los nodos es así:<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-6zGWxKfE3vU/Xm5C0-KZWFI/AAAAAAAABto/VaH8Fi-th8wuRDaLR7XeAi2zLSRNMR8ZgCLcBGAsYHQ/s1600/Captura%2Brealizada%2Bel%2B2020-03-15%2B08.54.08.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="263" data-original-width="227" height="400" src="https://1.bp.blogspot.com/-6zGWxKfE3vU/Xm5C0-KZWFI/AAAAAAAABto/VaH8Fi-th8wuRDaLR7XeAi2zLSRNMR8ZgCLcBGAsYHQ/s400/Captura%2Brealizada%2Bel%2B2020-03-15%2B08.54.08.png" width="345" /></a></div>El nodo principal como lo indica su ícono es un Control, el ColorRect lo agregué para rellenar el color de fondo y la app se pueda ajustar bien a las pantallas de los dispositivos sin que se vea donde concluye la imagen, usé el modo Expand en 2D para esto.<br /><br />En el nodo CenterContainer/Control coloqué los nodos que corresponden a "los mosquitos", de lo que explicaré mas adelante.<br /><br /><h2>El código base</h2><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-U7iKb1N-vas/Xm5DwZfohwI/AAAAAAAABt0/ham7-TyHsKMptJ9DNynLGpBzXE8Pa1cCQCLcBGAsYHQ/s1600/Captura%2Brealizada%2Bel%2B2020-03-15%2B08.53.42.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="676" data-original-width="931" height="464" src="https://1.bp.blogspot.com/-U7iKb1N-vas/Xm5DwZfohwI/AAAAAAAABt0/ham7-TyHsKMptJ9DNynLGpBzXE8Pa1cCQCLcBGAsYHQ/s640/Captura%2Brealizada%2Bel%2B2020-03-15%2B08.53.42.png" width="640" /></a></div>Como podrás ver usé el Giroscopio para realizar la app, anteriormente había intentado con el acelerómetro, sentí que se me podía complicar un poco por el tema de la gravedad.<br /><br />get_gyroscope() devuelve un Vector3, por lo que con eso puedo saber en qué dirección se está girando el celular, tomando en cuenta que al hacer el movimiento de la raqueta hay que hacer giros y estos giros pueden ir en cualquier dirección, lo que hice simplemente fue obtener la longitud (length) de éste y a partir de ahí solo hice una validación conforme el resultado para generar aleatoriamente los sonidos, entre mas baja la longitud, menos probable es que se ejecute un sonido.<br /><br />He utilizado el physics_process y no el _process para conseguir una aleatoriedad mas equilibrada, ya que la velocidad del _process depende del dispositivo y eso causaría que la experiencia sea distinta según el dispositivo. <br /><br />En la línea 23, el método spartk() es llamado del nodo de los mosquitos que muestro a continuación.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-YWluNzjQwoQ/Xm5Gr-vXQHI/AAAAAAAABug/iUyilWXsOnE1D9f_n40G1Nu7zvgCepYkwCLcBGAsYHQ/s1600/Captura%2Brealizada%2Bel%2B2020-03-15%2B09.15.47.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="321" data-original-width="228" height="400" src="https://1.bp.blogspot.com/-YWluNzjQwoQ/Xm5Gr-vXQHI/AAAAAAAABug/iUyilWXsOnE1D9f_n40G1Nu7zvgCepYkwCLcBGAsYHQ/s400/Captura%2Brealizada%2Bel%2B2020-03-15%2B09.15.47.png" width="283" /></a></div>Un total de 25 (por eso el randi()%25) nodos posicionados en distintas zonas de la raqueta para generar un efecto "realista" aunque cuando probé esto en el celular me dí cuenta que nadie lo notaría, pues al usar la raqueta la estás agitando y no se ve claramente el efecto, pero al final la pereza me obligó a dejarlo así.<br /><br /><h2>El nodo del mosquito</h2><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-SqBoAn5e_6E/Xm5HfffzhMI/AAAAAAAABuo/o5a4YBNCIKw61K6rr7zxxz7yu272xLXMQCLcBGAsYHQ/s1600/Captura%2Brealizada%2Bel%2B2020-03-15%2B09.14.21.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="156" data-original-width="244" height="255" src="https://1.bp.blogspot.com/-SqBoAn5e_6E/Xm5HfffzhMI/AAAAAAAABuo/o5a4YBNCIKw61K6rr7zxxz7yu272xLXMQCLcBGAsYHQ/s400/Captura%2Brealizada%2Bel%2B2020-03-15%2B09.14.21.png" width="400" /></a></div>En su momento lo nombré Star, porque usé unas texturas de estrellas para generar el efecto de chispa, el animation player es el responsable de hacer que la estrella aparezca y desaparezca como si de una chispa se tratase y usé el AudioStreamPlayer2D para que genere el efecto de posición, ya que este nodo hace que el volumen sea mas alto o mas bajo dependiendo de donde esté colocado el nodo.<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-BlvbKqjL6E0/Xm5IB0eXu2I/AAAAAAAABuw/dawFzWb9l14SDwGz7OOwaJd-4niDMPA2gCLcBGAsYHQ/s1600/Captura%2Brealizada%2Bel%2B2020-03-15%2B09.14.40.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="335" data-original-width="626" height="340" src="https://1.bp.blogspot.com/-BlvbKqjL6E0/Xm5IB0eXu2I/AAAAAAAABuw/dawFzWb9l14SDwGz7OOwaJd-4niDMPA2gCLcBGAsYHQ/s640/Captura%2Brealizada%2Bel%2B2020-03-15%2B09.14.40.png" width="640" /></a></div>El nodo entonces carga las texturas en el ready y aleatoriamente cada vez que es llamado el método spark() cambia de textura y se ejecuta la animación y el audio, adicionalmente le agregué un pitch_scale aleatorio porque usé solo un sonido y alterando un poco el pitch consigo que se sienta mas realista.<br /><br />En fín, tardé unos 30 minutos en programar la app y me he divertido haciendola, pero mas me divertí cuando la probé por primera vez, y es que creo que conseguí simular muy bien la raqueta.<br /><br />Link de la app en google play: <a href="https://play.google.com/store/apps/details?id=com.damv.raqueta_mata_mosquitos" target="_blank">https://play.google.com/store/apps/details?id=com.damv.raqueta_mata_mosquitos</a><br />Link del código fuente en github: <a href="https://github.com/DeybisMelendez/raqueta-mata-mosquitos" target="_blank">https://github.com/DeybisMelendez/raqueta-mata-mosquitos</a>